(function(S,m){typeof exports=="object"&&typeof module!="undefined"?m(exports):typeof define=="function"&&define.amd?define(["exports"],m):(S=typeof globalThis!="undefined"?globalThis:S||self,m(S.MMAPI={}))})(this,function(S){"use strict";class m{constructor(i){this.eventName=i}}class U extends m{constructor(i){super("packet"),this.packet=i,this.payload=i[1]}}class Y extends U{constructor(i){super(i),this.type=i[0]}}class y extends U{constructor(i){super(i),this.isCanceled=!1,this.type=i[0]}}class K extends m{constructor(i){super("player"),this.player=i}}class V extends m{constructor(i,r){super("health"),this.sid=i,this.health=r}}class C extends m{constructor(i){super("build"),this.building=i}}class X extends C{constructor(i){super(i)}}class W extends C{constructor(i,r){super(i),this.reason=r}}class J extends m{constructor(i,r){super("chat"),this.sid=i,this.message=r}}class q extends m{constructor(i){super("servertick"),this.playerData=i}}class F{constructor(i,r,f=!1){this.name=i,this.cb=r,this.once=f}}class Q{constructor(){this.events=[]}on(i,r){this.events.push(new F(i,r))}once(i,r){this.events.push(new F(i,r,!0))}emit(i,r){this.events.filter(f=>f.name!=i?!0:(f.cb(r),!f.once))}removeEvent(i){this.events.forEach(r=>{r.name==i&&(r.once=!0)})}}var x=(e=>(e.SPAWN="sp",e.CHAT="ch",e.ATTACK="c",e.PING="pp",e.SET_ANGLE="2",e.SELECT_ITEM="5",e.UPGRADE="6",e.AUTO_ATTACK="7",e.CREATE_TRIBE="8",e.LEAVE_TRIBE="9",e.REQUEST_JOIN_TRIBE="10",e.ACCEPT_TRIBE_REQUEST="11",e.KICK_FROM_TRIBE="12",e.BUY_AND_EQUIP="13c",e.PING_MAP="14",e.MOVE="33",e))(x||{}),d=(e=>(e.ANNOUNCE="ann",e.INIT="io-init",e.INIT_TRIBES="id",e.SET_SID="1",e.KICK="d",e.ADD_PLAYER="2",e.UPDAE_PLAYERS="33",e.REMOVE_PLAYER="4",e.UPDATE_LEADER_BOARD="5",e.ADD_OBJECT="6",e.UPDATE_AIS="a",e.PLAYER_SWING="7",e.MOOSTAFA_SWING="aa",e.WIGGLE="8",e.SHOOT_TURRET="sp",e.UPDATE_MATS="9",e.HEALTH="h",e.DEATH="11",e.REMOVE_OBJECT="12",e.REMOVE_ALL_OBJECTS="13",e.SET_ITEM_COUNT="14",e.SET_AGE="15",e.LIST_UPGRADES="16",e.SET_ITEMS_BAR="17",e.ADD_PROJECTILE="18",e.REMOVE_PROJECTILE="19",e.SERVER_RESTART="20",e.ADD_TRIBE="ac",e.DELETE_TRIBE="ad",e.REQUEST_JOIN_TRIBE="an",e.SET_TRIBE="st",e.SET_TRIBE_MEMBERS="sa",e.MINIMAP_LOCATIONS="mm",e.CHAT="ch",e.UPDATE_SHOP="us",e.PING="pp",e.DAMAGE_TEST="t",e.PING_MAP="p",e))(d||{}),A=(e=>(e[e.APPLE=0]="APPLE",e[e.COOKIE=1]="COOKIE",e[e.CHEESE=2]="CHEESE",e[e.WOOD_WALL=3]="WOOD_WALL",e[e.STONE_WALL=4]="STONE_WALL",e[e.CASTLE_WALL=5]="CASTLE_WALL",e[e.SPIKE=6]="SPIKE",e[e.GREATER_SPIKE=7]="GREATER_SPIKE",e[e.POISON_SPIKE=8]="POISON_SPIKE",e[e.SPINNING_SPIKE=9]="SPINNING_SPIKE",e[e.WINDMILL=10]="WINDMILL",e[e.FASTER_WINDMILL=11]="FASTER_WINDMILL",e[e.POWER_MILL=12]="POWER_MILL",e[e.MINE=13]="MINE",e[e.SAPPLING=14]="SAPPLING",e[e.PIT_TRAP=15]="PIT_TRAP",e[e.BOOST_PAD=16]="BOOST_PAD",e[e.TURRET=17]="TURRET",e[e.PLATFORM=18]="PLATFORM",e[e.HEALING_PAD=19]="HEALING_PAD",e[e.SPAWN_PAD=20]="SPAWN_PAD",e[e.BLOCKER=21]="BLOCKER",e[e.TELEPORTER=22]="TELEPORTER",e))(A||{}),B=(e=>(e[e.TOOL_HAMMER=0]="TOOL_HAMMER",e[e.HAND_AXE=1]="HAND_AXE",e[e.GREAT_AXE=2]="GREAT_AXE",e[e.SHORT_SWORD=3]="SHORT_SWORD",e[e.KATANA=4]="KATANA",e[e.POLE_ARM=5]="POLE_ARM",e[e.BAT=6]="BAT",e[e.DAGGERS=7]="DAGGERS",e[e.STICK=8]="STICK",e[e.HUNTING_BOW=9]="HUNTING_BOW",e[e.GREAT_HAMMER=10]="GREAT_HAMMER",e[e.WOODEN_SHIELD=11]="WOODEN_SHIELD",e[e.CROSSBOW=12]="CROSSBOW",e[e.REPEATER_CROSSBOW=13]="REPEATER_CROSSBOW",e[e.MC_GRABBY=14]="MC_GRABBY",e[e.MUSKET=15]="MUSKET",e))(B||{}),P={};Object.defineProperty(P,"__esModule",{value:!0});var H=P.Pos=P.PrimitivePos=void 0;class b{constructor(i=0,r=0){this.x=i,this.y=r}normalize(){return new N(this.x,this.y)}}P.PrimitivePos=b;class N extends b{constructor(i=0,r=0){super(i,r),this.x=i,this.y=r}clone(){return new N(this.x,this.y)}addX(i){const r=this.clone();return r.x+=i,r}addY(i){const r=this.clone();return r.y+=i,r}add(i,r){return i instanceof N?this.addX(i.x).addY(i.y):this.addX(i).addY(r||0)}toString(){return`X: ${this.x} Y: ${this.y}`}asPrimitive(){return new b(this.x,this.y)}}H=P.Pos=N;class G{constructor(){this.x=-2,this.y=-2,this.sid=-2,this.id="NULL",this.dir=0,this.currentObject=-2,this.wep=-2,this.variant=-2,this.tribe="NULL",this.isLeader=!1,this.hat=-2,this.acc=-2,this.isSkull=!1,this.zIndex=-1,this.health=100,this.name="NULL",this.chatMessage=null,this.messageTimeout=-1}assign(i){this.x=i.x,this.y=i.y,this.sid=i.sid,this.dir=i.dir,this.currentObject=i.currentObject,this.wep=i.wep,this.variant=i.variant,this.tribe=i.tribe,this.isLeader=i.isLeader,this.hat=i.hat,this.acc=i.acc,this.isSkull=i.isSkull,this.zIndex=i.zIndex}getAsPos(){return new H(this.x,this.y)}}class Z extends G{constructor(){super(...arguments),this.weapons=[B.TOOL_HAMMER,void 0],this.items=[A.APPLE,A.WOOD_WALL,A.SPIKE,A.WINDMILL,void 0,void 0,void 0,void 0]}getFoodType(){return this.items[0]}getWallType(){return this.items[1]}getSpikeType(){return this.items[2]}getMillType(){return this.items[3]}searchForId(i){for(let r of this.items)if(r==i)return r;return null}getSapplingType(){return this.searchForId(A.SAPPLING)}getMineType(){return this.searchForId(A.MINE)}getSpecialType(){return this.searchForId(A.TURRET)||this.searchForId(A.BLOCKER)||this.searchForId(A.HEALING_PAD)||this.searchForId(A.PLATFORM)||this.searchForId(A.TELEPORTER)}getPadType(){return this.items[4]||null}getPrimaryType(){return this.weapons[0]}getSecondaryType(){return this.weapons[1]}}function $(e){let r,f,c=new Uint8Array(128),a=0;return h(e),c.subarray(0,a);function h(t){switch(typeof t){case"undefined":u();break;case"boolean":L(t);break;case"number":g(t);break;case"string":O(t);break;case"object":t===null?u():t instanceof Date?n(t):Array.isArray(t)?T(t):t instanceof Uint8Array||t instanceof Uint8ClampedArray?p(t):t instanceof Int8Array||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array?T(t):M(t);break}}function u(t){E(192)}function L(t){E(t?195:194)}function g(t){if(isFinite(t)&&Math.floor(t)===t)if(t>=0&&t<=127)E(t);else if(t<0&&t>=-32)E(t);else if(t>0&&t<=255)o([204,t]);else if(t>=-128&&t<=127)o([208,t]);else if(t>0&&t<=65535)o([205,t>>>8,t]);else if(t>=-32768&&t<=32767)o([209,t>>>8,t]);else if(t>0&&t<=4294967295)o([206,t>>>24,t>>>16,t>>>8,t]);else if(t>=-2147483648&&t<=2147483647)o([210,t>>>24,t>>>16,t>>>8,t]);else if(t>0&&t<=18446744073709552e3){let s=t/4294967296,l=t%4294967296;o([211,s>>>24,s>>>16,s>>>8,s,l>>>24,l>>>16,l>>>8,l])}else t>=-9223372036854776e3&&t<=9223372036854776e3?(E(211),_(t)):t<0?o([211,128,0,0,0,0,0,0,0]):o([207,255,255,255,255,255,255,255,255]);else f||(r=new ArrayBuffer(8),f=new DataView(r)),f.setFloat64(0,t),E(203),o(new Uint8Array(r))}function O(t){let s=I(t),l=s.length;l<=31?E(160+l):l<=255?o([217,l]):l<=65535?o([218,l>>>8,l]):o([219,l>>>24,l>>>16,l>>>8,l]),o(s)}function T(t){let s=t.length;s<=15?E(144+s):s<=65535?o([220,s>>>8,s]):o([221,s>>>24,s>>>16,s>>>8,s]);for(let l=0;l<s;l++)h(t[l])}function p(t){let s=t.length;s<=15?o([196,s]):s<=65535?o([197,s>>>8,s]):o([198,s>>>24,s>>>16,s>>>8,s]),o(t)}function M(t){let s=0;for(let l in t)s++;s<=15?E(128+s):s<=65535?o([222,s>>>8,s]):o([223,s>>>24,s>>>16,s>>>8,s]);for(let l in t)h(l),h(t[l])}function n(t){let s=t.getTime()/1e3;if(t.getMilliseconds()===0&&s>=0&&s<4294967296)o([214,255,s>>>24,s>>>16,s>>>8,s]);else if(s>=0&&s<17179869184){let l=t.getMilliseconds()*1e6;o([215,255,l>>>22,l>>>14,l>>>6,l<<2>>>0|s/4294967296,s>>>24,s>>>16,s>>>8,s])}else{let l=t.getMilliseconds()*1e6;o([199,12,255,l>>>24,l>>>16,l>>>8,l]),_(s)}}function E(t){if(c.length<a+1){let s=c.length*2;for(;s<a+1;)s*=2;let l=new Uint8Array(s);l.set(c),c=l}c[a]=t,a++}function o(t){if(c.length<a+t.length){let s=c.length*2;for(;s<a+t.length;)s*=2;let l=new Uint8Array(s);l.set(c),c=l}c.set(t,a),a+=t.length}function _(t){let s,l;t>=0?(s=t/4294967296,l=t%4294967296):(t++,s=Math.abs(t)/4294967296,l=Math.abs(t)%4294967296,s=~s,l=~l),o([s>>>24,s>>>16,s>>>8,s,l>>>24,l>>>16,l>>>8,l])}}function z(e){let r=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),typeof e!="object"||typeof e.length=="undefined")throw new Error("Invalid argument type: Expected a byte array (Array or Uint8Array) to deserialize.");if(!e.length)throw new Error("Invalid argument: The byte array to deserialize is empty.");e instanceof Uint8Array||(e=new Uint8Array(e));let f=c();return r<e.length,f;function c(){const n=e[r++];if(n>=0&&n<=127)return n;if(n>=128&&n<=143)return g(n-128);if(n>=144&&n<=159)return O(n-144);if(n>=160&&n<=191)return T(n-160);if(n===192)return null;if(n===193)throw new Error("Invalid byte code 0xc1 found.");if(n===194)return!1;if(n===195)return!0;if(n===196)return L(-1,1);if(n===197)return L(-1,2);if(n===198)return L(-1,4);if(n===199)return p(-1,1);if(n===200)return p(-1,2);if(n===201)return p(-1,4);if(n===202)return u(4);if(n===203)return u(8);if(n===204)return h(1);if(n===205)return h(2);if(n===206)return h(4);if(n===207)return h(8);if(n===208)return a(1);if(n===209)return a(2);if(n===210)return a(4);if(n===211)return a(8);if(n===212)return p(1);if(n===213)return p(2);if(n===214)return p(4);if(n===215)return p(8);if(n===216)return p(16);if(n===217)return T(-1,1);if(n===218)return T(-1,2);if(n===219)return T(-1,4);if(n===220)return O(-1,2);if(n===221)return O(-1,4);if(n===222)return g(-1,2);if(n===223)return g(-1,4);if(n>=224&&n<=255)return n-256;throw console.debug("msgpack array:",e),new Error("Invalid byte value '"+n+"' at index "+(r-1)+" in the MessagePack binary data (length "+e.length+"): Expecting a range of 0 to 255. This is not a byte array.")}function a(n){let E=0,o=!0;for(;n-- >0;)if(o){let _=e[r++];E+=_&127,_&128&&(E-=128),o=!1}else E*=256,E+=e[r++];return E}function h(n){let E=0;for(;n-- >0;)E*=256,E+=e[r++];return E}function u(n){let E=new DataView(e.buffer,r,n);if(r+=n,n===4)return E.getFloat32(0,!1);if(n===8)return E.getFloat64(0,!1)}function L(n,E){n<0&&(n=h(E));let o=e.subarray(r,r+n);return r+=n,o}function g(n,E){n<0&&(n=h(E));let o={};for(;n-- >0;){let _=c();o[_]=c()}return o}function O(n,E){n<0&&(n=h(E));let o=[];for(;n-- >0;)o.push(c());return o}function T(n,E){n<0&&(n=h(E));let o=r;return r+=n,ee(e,o,n)}function p(n,E){n<0&&(n=h(E));let o=h(1),_=L(n);switch(o){case 255:return M(_)}return{type:o,data:_}}function M(n){if(n.length===4){let E=(n[0]<<24>>>0)+(n[1]<<16>>>0)+(n[2]<<8>>>0)+n[3];return new Date(E*1e3)}if(n.length===8){let E=(n[0]<<22>>>0)+(n[1]<<14>>>0)+(n[2]<<6>>>0)+(n[3]>>>2),o=(n[3]&3)*4294967296+(n[4]<<24>>>0)+(n[5]<<16>>>0)+(n[6]<<8>>>0)+n[7];return new Date(o*1e3+E/1e6)}if(n.length===12){let E=(n[0]<<24>>>0)+(n[1]<<16>>>0)+(n[2]<<8>>>0)+n[3];r-=8;let o=a(8);return new Date(o*1e3+E/1e6)}throw new Error("Invalid data length for a date value.")}}function I(e){let i=!0,r=e.length;for(let a=0;a<r;a++)if(e.charCodeAt(a)>127){i=!1;break}let f=0,c=new Uint8Array(e.length*(i?1:4));for(let a=0;a!==r;a++){let h=e.charCodeAt(a);if(h<128){c[f++]=h;continue}if(h<2048)c[f++]=h>>6|192;else{if(h>55295&&h<56320){if(++a>=r)throw new Error("UTF-8 encode: incomplete surrogate pair");let u=e.charCodeAt(a);if(u<56320||u>57343)throw new Error("UTF-8 encode: second surrogate character 0x"+u.toString(16)+" at index "+a+" out of range");h=65536+((h&1023)<<10)+(u&1023),c[f++]=h>>18|240,c[f++]=h>>12&63|128}else c[f++]=h>>12|224;c[f++]=h>>6&63|128}c[f++]=h&63|128}return i?c:c.subarray(0,f)}function ee(e,i,r){let f=i,c="";for(r+=i;f<r;){let a=e[f++];if(a>127)if(a>191&&a<224){if(f>=r)throw new Error("UTF-8 decode: incomplete 2-byte sequence");a=(a&31)<<6|e[f++]&63}else if(a>223&&a<240){if(f+1>=r)throw new Error("UTF-8 decode: incomplete 3-byte sequence");a=(a&15)<<12|(e[f++]&63)<<6|e[f++]&63}else if(a>239&&a<248){if(f+2>=r)throw new Error("UTF-8 decode: incomplete 4-byte sequence");a=(a&7)<<18|(e[f++]&63)<<12|(e[f++]&63)<<6|e[f++]&63}else throw new Error("UTF-8 decode: unknown multibyte start 0x"+a.toString(16)+" at index "+(f-1));if(a<=65535)c+=String.fromCharCode(a);else if(a<=1114111)a-=65536,c+=String.fromCharCode(a>>10|55296),c+=String.fromCharCode(a&1023|56320);else throw new Error("UTF-8 decode: code point 0x"+a.toString(16)+" exceeds UTF-16 reach")}return c}var ie=Object.freeze(Object.defineProperty({__proto__:null,msgpack:{encode:$,decode:z}},Symbol.toStringTag,{value:"Module"})),v=(e=>(e[e.BROWN=0]="BROWN",e[e.BEIGE=1]="BEIGE",e[e.DARKBROWN=2]="DARKBROWN",e[e.PEACH=3]="PEACH",e[e.WHITE=4]="WHITE",e[e.RED=5]="RED",e[e.BLACK=6]="BLACK",e[e.PINK=7]="PINK",e[e.BLUE=8]="BLUE",e[e.GREEN=9]="GREEN",e.SECRETLIGHTBLUE="length",e))(v||{});class te{constructor(i,r,f){this.cb=i,this.msInterval=r,this.keyCode=f,this.intervalId=null}start(i){this.keyCode!=i||this.intervalId!=null||(this.intervalId=setInterval(this.cb,this.msInterval))}stop(i){this.keyCode!=i||this.intervalId==null||(clearInterval(this.intervalId),this.intervalId=null)}}var D=(e=>(e[e.PLAYERLEAVE=0]="PLAYERLEAVE",e[e.BUILDINGBREAK=1]="BUILDINGBREAK",e))(D||{}),k=(e=>(e[e.SHAME=45]="SHAME",e[e.MOO_CAP=51]="MOO_CAP",e[e.APPLE_CAP=50]="APPLE_CAP",e[e.MOO_HEAD=28]="MOO_HEAD",e[e.PIG_HEAD=29]="PIG_HEAD",e[e.FLUFF_HEAD=30]="FLUFF_HEAD",e[e.PANDOU_HEAD=36]="PANDOU_HEAD",e[e.BEAR_HEAD=37]="BEAR_HEAD",e[e.MONKEY_HEAD=38]="MONKEY_HEAD",e[e.POLAR_HEAD=44]="POLAR_HEAD",e[e.FEZ_HAT=35]="FEZ_HAT",e[e.ENIGMA_HAT=42]="ENIGMA_HAT",e[e.BLITZ_HAT=43]="BLITZ_HAT",e[e.BOB_XIII_HAT=49]="BOB_XIII_HAT",e[e.PUMPKIN=57]="PUMPKIN",e[e.BUMMLE_HAT=8]="BUMMLE_HAT",e[e.STRAW_HAT=2]="STRAW_HAT",e[e.WINTER_CAP=15]="WINTER_CAP",e[e.COWBOY_HAT=5]="COWBOY_HAT",e[e.RANGER_HAT=4]="RANGER_HAT",e[e.EXPLORER_HAT=18]="EXPLORER_HAT",e[e.FLIPPER_HAT=31]="FLIPPER_HAT",e[e.MARKSMAN_CAP=1]="MARKSMAN_CAP",e[e.BUSH_GEAR=10]="BUSH_GEAR",e[e.HALO=48]="HALO",e[e.SOLDIER_HELMET=6]="SOLDIER_HELMET",e[e.ANTI_VENOM_GEAR=23]="ANTI_VENOM_GEAR",e[e.MEDIC_GEAR=13]="MEDIC_GEAR",e[e.MINERS_HELMET=9]="MINERS_HELMET",e[e.MUSKETEER_HAT=32]="MUSKETEER_HAT",e[e.BULL_HELMET=7]="BULL_HELMET",e[e.EMP_HELMET=22]="EMP_HELMET",e[e.BOOSTER_HAT=12]="BOOSTER_HAT",e[e.BARBARIAN_ARMOR=26]="BARBARIAN_ARMOR",e[e.PLAGUE_MASK=21]="PLAGUE_MASK",e[e.BULL_MASK=46]="BULL_MASK",e[e.WINDMILL_HAT=14]="WINDMILL_HAT",e[e.SPIKE_GEAR=11]="SPIKE_GEAR",e[e.TURRET_GEAR=53]="TURRET_GEAR",e[e.SAMURAI_ARMOR=20]="SAMURAI_ARMOR",e[e.DARK_KNIGHT=58]="DARK_KNIGHT",e[e.SCAVENGER_GEAR=27]="SCAVENGER_GEAR",e[e.TANK_GEAR=40]="TANK_GEAR",e[e.THIEF_GEAR=40]="THIEF_GEAR",e[e.BLOODTHIRSTER=55]="BLOODTHIRSTER",e[e.Assassin_GEAR=56]="Assassin_GEAR",e))(k||{});const re=[{id:45,name:"Shame!",dontSell:!0,price:0,scale:120,desc:"hacks are for losers"},{id:51,name:"Moo Cap",price:0,scale:120,desc:"coolest mooer around"},{id:50,name:"Apple Cap",price:0,scale:120,desc:"apple farms remembers"},{id:28,name:"Moo Head",price:0,scale:120,desc:"no effect"},{id:29,name:"Pig Head",price:0,scale:120,desc:"no effect"},{id:30,name:"Fluff Head",price:0,scale:120,desc:"no effect"},{id:36,name:"Pandou Head",price:0,scale:120,desc:"no effect"},{id:37,name:"Bear Head",price:0,scale:120,desc:"no effect"},{id:38,name:"Monkey Head",price:0,scale:120,desc:"no effect"},{id:44,name:"Polar Head",price:0,scale:120,desc:"no effect"},{id:35,name:"Fez Hat",price:0,scale:120,desc:"no effect"},{id:42,name:"Enigma Hat",price:0,scale:120,desc:"join the enigma army"},{id:43,name:"Blitz Hat",price:0,scale:120,desc:"hey everybody i'm blitz"},{id:49,name:"Bob XIII Hat",price:0,scale:120,desc:"like and subscribe"},{id:57,name:"Pumpkin",price:50,scale:120,desc:"Spooooky"},{id:8,name:"Bummle Hat",price:100,scale:120,desc:"no effect"},{id:2,name:"Straw Hat",price:500,scale:120,desc:"no effect"},{id:15,name:"Winter Cap",price:600,scale:120,desc:"allows you to move at normal speed in snow",coldM:1},{id:5,name:"Cowboy Hat",price:1e3,scale:120,desc:"no effect"},{id:4,name:"Ranger Hat",price:2e3,scale:120,desc:"no effect"},{id:18,name:"Explorer Hat",price:2e3,scale:120,desc:"no effect"},{id:31,name:"Flipper Hat",price:2500,scale:120,desc:"have more control while in water",watrImm:!0},{id:1,name:"Marksman Cap",price:3e3,scale:120,desc:"increases arrow speed and range",aMlt:1.3},{id:10,name:"Bush Gear",price:3e3,scale:160,desc:"allows you to disguise yourself as a bush"},{id:48,name:"Halo",price:3e3,scale:120,desc:"no effect"},{id:6,name:"Soldier Helmet",price:4e3,scale:120,desc:"reduces damage taken but slows movement",spdMult:.94,dmgMult:.75},{id:23,name:"Anti Venom Gear",price:4e3,scale:120,desc:"makes you immune to poison",poisonRes:1},{id:13,name:"Medic Gear",price:5e3,scale:110,desc:"slowly regenerates health over time",healthRegen:3},{id:9,name:"Miners Helmet",price:5e3,scale:120,desc:"earn 1 extra gold per resource",extraGold:1},{id:32,name:"Musketeer Hat",price:5e3,scale:120,desc:"reduces cost of projectiles",projCost:.5},{id:7,name:"Bull Helmet",price:6e3,scale:120,desc:"increases damage done but drains health",healthRegen:-5,dmgMultO:1.5,spdMult:.96},{id:22,name:"Emp Helmet",price:6e3,scale:120,desc:"turrets won't attack but you move slower",antiTurret:1,spdMult:.7},{id:12,name:"Booster Hat",price:6e3,scale:120,desc:"increases your movement speed",spdMult:1.16},{id:26,name:"Barbarian Armor",price:8e3,scale:120,desc:"knocks back enemies that attack you",dmgK:.6},{id:21,name:"Plague Mask",price:1e4,scale:120,desc:"melee attacks deal poison damage",poisonDmg:5,poisonTime:6},{id:46,name:"Bull Mask",price:1e4,scale:120,desc:"bulls won't target you unless you attack them",bullRepel:1},{id:14,name:"Windmill Hat",topSprite:!0,price:1e4,scale:120,desc:"generates points while worn",pps:1.5},{id:11,name:"Spike Gear",topSprite:!0,price:1e4,scale:120,desc:"deal damage to players that damage you",dmg:.45},{id:53,name:"Turret Gear",topSprite:!0,price:1e4,scale:120,desc:"you become a walking turret",turret:{proj:1,range:700,rate:2500},spdMult:.7},{id:20,name:"Samurai Armor",price:12e3,scale:120,desc:"increased attack speed and fire rate",atkSpd:.78},{id:58,name:"Dark Knight",price:12e3,scale:120,desc:"restores health when you deal damage",healD:.4},{id:27,name:"Scavenger Gear",price:15e3,scale:120,desc:"earn double points for each kill",kScrM:2},{id:40,name:"Tank Gear",price:15e3,scale:120,desc:"increased damage to buildings but slower movement",spdMult:.3,bDmg:3.3},{id:52,name:"Thief Gear",price:15e3,scale:120,desc:"steal half of a players gold when you kill them",goldSteal:.5},{id:55,name:"Bloodthirster",price:2e4,scale:120,desc:"Restore Health when dealing damage. And increased damage",healD:.25,dmgMultO:1.2},{id:56,name:"Assassin Gear",price:2e4,scale:120,desc:"Go invisible when not moving. Can't eat. Increased speed",noEat:!0,spdMult:1.1,invisTimer:1e3}];var j=(e=>(e[e.SNOWBALL=12]="SNOWBALL",e[e.TREE_CAPE=9]="TREE_CAPE",e[e.STONE_CAPE=10]="STONE_CAPE",e[e.COOKIE_CAPE=3]="COOKIE_CAPE",e[e.COW_CAPE=8]="COW_CAPE",e[e.MONKEY_TAIL=11]="MONKEY_TAIL",e[e.APPLE_BASKET=17]="APPLE_BASKET",e[e.WINTER_CAPE=6]="WINTER_CAPE",e[e.SKULL_CAPE=4]="SKULL_CAPE",e[e.DASH_CAPE=5]="DASH_CAPE",e[e.DRAGON_CAPE=2]="DRAGON_CAPE",e[e.SUPER_CAPE=1]="SUPER_CAPE",e[e.TROLL_CAPE=7]="TROLL_CAPE",e[e.THORNS=14]="THORNS",e[e.BLOCKADES=15]="BLOCKADES",e[e.DEVILS_TAIL=20]="DEVILS_TAIL",e[e.SAWBLADE=16]="SAWBLADE",e[e.ANGEL_WINGS=13]="ANGEL_WINGS",e[e.SHADOW_WINGS=19]="SHADOW_WINGS",e[e.BLOOD_WINGS=18]="BLOOD_WINGS",e[e.CORRUPT_X_WINGS=21]="CORRUPT_X_WINGS",e))(j||{});const ne=[{id:12,name:"Snowball",price:1e3,scale:105,xOff:18,desc:"no effect"},{id:9,name:"Tree Cape",price:1e3,scale:90,desc:"no effect"},{id:10,name:"Stone Cape",price:1e3,scale:90,desc:"no effect"},{id:3,name:"Cookie Cape",price:1500,scale:90,desc:"no effect"},{id:8,name:"Cow Cape",price:2e3,scale:90,desc:"no effect"},{id:11,name:"Monkey Tail",price:2e3,scale:97,xOff:25,desc:"Super speed but reduced damage",spdMult:1.35,dmgMultO:.2},{id:17,name:"Apple Basket",price:3e3,scale:80,xOff:12,desc:"slowly regenerates health over time",healthRegen:1},{id:6,name:"Winter Cape",price:3e3,scale:90,desc:"no effect"},{id:4,name:"Skull Cape",price:4e3,scale:90,desc:"no effect"},{id:5,name:"Dash Cape",price:5e3,scale:90,desc:"no effect"},{id:2,name:"Dragon Cape",price:6e3,scale:90,desc:"no effect"},{id:1,name:"Super Cape",price:8e3,scale:90,desc:"no effect"},{id:7,name:"Troll Cape",price:8e3,scale:90,desc:"no effect"},{id:14,name:"Thorns",price:1e4,scale:115,xOff:20,desc:"no effect"},{id:15,name:"Blockades",price:1e4,scale:95,xOff:15,desc:"no effect"},{id:20,name:"Devils Tail",price:1e4,scale:95,xOff:20,desc:"no effect"},{id:16,name:"Sawblade",price:12e3,scale:90,spin:!0,xOff:0,desc:"deal damage to players that damage you",dmg:.15},{id:13,name:"Angel Wings",price:15e3,scale:138,xOff:22,desc:"slowly regenerates health over time",healthRegen:3},{id:19,name:"Shadow Wings",price:15e3,scale:138,xOff:22,desc:"increased movement speed",spdMult:1.1},{id:18,name:"Blood Wings",price:2e4,scale:178,xOff:26,desc:"restores health when you deal damage",healD:.2},{id:21,name:"Corrupt X Wings",price:2e4,scale:178,xOff:26,desc:"deal damage to players that damage you",dmg:.25}];var se=ie;const w=se.msgpack;class R extends Q{constructor(i=!1){super(),this.socket=null,this.player=new Z,this.players=[],this.gameObjects=[],this.alive=!1,this.hatsOwned={},this.accessoriesOwned={};const r=this;if(i)Object.defineProperty(WebSocket.prototype,"hiddenSend",{value:WebSocket.prototype.send}),Object.defineProperty(WebSocket.prototype,"send",{value:function(f){r.socket==null&&(r.socket=this);const c=new y(w.decode(new Uint8Array(f)));if(r.emit("packetSend",c),c.isCanceled)return;c.type==x.SPAWN&&(r.alive=!0),this.hiddenSend(f)}});else{class f extends WebSocket{hiddenSend(a){super.send(a)}constructor(a){super(a),this.send=h=>{const u=new y(w.decode(new Uint8Array(h)));r.emit("packetSend",u),!u.isCanceled&&(u.type==x.SPAWN&&(r.alive=!0),this.hiddenSend(h))},r.socket=this,r.initSocket()}}Object.defineProperty(window,"WebSocket",{value:f})}re.forEach(f=>{f.price<=0&&!f.dontSell&&(this.hatsOwned[f.id]=!0)}),ne.forEach(f=>{f.price<=0&&(this.accessoriesOwned[f.id]=!0)})}initSocket(){var i;(i=this.socket)==null||i.addEventListener("message",r=>{const f=new Y(w.decode(new Uint8Array(r.data)));this.emit("packetReceive",f);const c=f.payload;switch(f.type){case d.HEALTH:const L=c[0];this.emit("health",new V(L,c[1])),this.players[L].health=c[1];break;case d.INIT:this.player.id=c[0];break;case d.SET_SID:this.players[c[0]]=this.player,this.player.sid=c[0];break;case d.UPDAE_PLAYERS:var h=[];for(let t=0;t<c[0].length;t+=13){const s=c[0].slice(t,t+13),l={sid:s[0],x:s[1],y:s[2],dir:s[3],currentObject:s[4],wep:s[5],variant:s[6],tribe:s[7],isLeader:s[8],hat:s[9],acc:s[10],isSkull:s[11],zIndex:s[12]};this.players[l.sid]||(console.warn("Ran into unpredicted circumstance current player cannot be found, IPlayerDat, this.players, IPlayerDat.sid",l,this.players,l.sid),this.players[l.sid]=new G),this.emit("updatePlayer",l),this.players[l.sid].assign(l),h.push(l)}this.emit("serverTick",new q(h));break;case d.REMOVE_PLAYER:const g=this.getPlayerById(c[0]);g&&(this.emit("playerLeave",new K(g)),delete this.players[g.sid]);break;case d.ADD_PLAYER:const O=c[0],T=O[1];var u=this.player;T!=this.player.sid&&(u=new G),u.sid=T,u.id=O[0],u.name=O[2],u.x=O[3],u.y=O[4],this.players[T]=u,this.emit("addPlayer",new K(u));break;case d.ADD_OBJECT:for(let t=0;t<c[0].length;t+=8){const s=c[0].slice(t,t+8),l={id:s[0],x:s[1],y:s[2],dir:s[3],scale:s[4],type:s[5],buildType:s[6],ownerSid:s[7]};this.gameObjects[l.id]=l,this.emit("addObject",new X(l))}break;case d.REMOVE_OBJECT:this.emit("removeObject",new W(this.gameObjects[c[0]],D.BUILDINGBREAK)),delete this.gameObjects[c[0]];break;case d.REMOVE_ALL_OBJECTS:for(let t=0;t<this.gameObjects.length;t++){const s=this.gameObjects[t];!s||s.ownerSid==c[0]&&(this.emit("removeObject",new W(this.gameObjects[t],D.PLAYERLEAVE)),this.gameObjects.slice(t,1))}break;case d.SET_ITEMS_BAR:c[0]&&(c[1]?this.player.weapons=c[0]:this.player.items=c[0]);break;case d.DEATH:this.player.weapons=[B.TOOL_HAMMER,void 0],this.player.items=[A.APPLE,A.WOOD_WALL,A.SPIKE,A.WINDMILL,void 0,void 0,void 0,void 0];break;case d.CHAT:const p=c[0],M=this.getPlayerBySid(p);if(M==null)return;const n=c[1];clearTimeout(M.messageTimeout),M.chatMessage=n,M.messageTimeout=setTimeout(()=>{M.chatMessage=null},3e3),this.emit("chat",new J(p,n));break;case d.UPDATE_SHOP:if(c[0])break;const o=c[2],_=c[1];o?this.accessoriesOwned[_]=!0:this.hatsOwned[_]=!0;break}})}getPlayerById(i){for(let r of this.players)if((r==null?void 0:r.id)==i)return r;return null}getPlayerBySid(i){for(let r of this.players)if((r==null?void 0:r.sid)==i)return r;return null}sendRaw(i){var r;(r=this.socket)==null||r.send(w.encode(i))}sendBasic(i,...r){this.sendRaw([i,r])}sendHidden(i,...r){var f=this.socket;f==null||f.hiddenSend(w.encode([i,r]))}spawn(i="moomooapi",r=v.RED,f=!0){this.sendBasic(x.SPAWN,{name:i,skin:r,moofoll:f})}setHand(i,r){this.sendBasic(x.SELECT_ITEM,i,r)}setItem(i){this.setHand(i,!1)}setWeapon(i){this.setHand(i,!0)}attack(i,r=null){this.sendBasic(x.ATTACK,i,r)}singleSwing(i=null){this.attack(!0,i),this.attack(!1)}placeItem(i,r=null){this.setItem(i),this.singleSwing(r),this.setWeapon(this.player.wep)}toggleAutoFire(){this.sendBasic(x.AUTO_ATTACK,1)}setGear(i,r,f){this.sendBasic(x.BUY_AND_EQUIP,i,r,f)}buyGear(i,r){this.setGear(!0,i,r)}buyHat(i){this.buyGear(i,!1)}equipGear(i,r){this.setGear(!1,i,r)}equipHat(i){this.equipGear(i,!1)}buyAccessory(i){this.buyGear(i,!0)}equipAccessory(i){this.equipGear(i,!0)}chat(i){this.sendBasic(x.CHAT,i)}}R.SkinColours=v,R.C2SPacketType=x,R.S2CPacketType=d,R.ObjectRemoveReason=D,R.ItemIds=A,R.WeaponIds=B,R.Repeater=te,R.msgpack=w,R.HatIds=k,R.AccessoryIds=j,Object.defineProperty(window,"MooMooAPI",{value:R}),S.MooMooAPI=R,S.msgpack2=w,Object.defineProperties(S,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
