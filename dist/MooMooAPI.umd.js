(function(S,P){typeof exports=="object"&&typeof module!="undefined"?P(exports):typeof define=="function"&&define.amd?define(["exports"],P):(S=typeof globalThis!="undefined"?globalThis:S||self,P(S.MMAPI={}))})(this,function(S){"use strict";var P={},d={};Object.defineProperty(d,"__esModule",{value:!0}),d.randInt=d.randFloat=d.averageAngle=d.lerpPos=d.lerp=d.toDeg=d.toRad=d.calcVec=d.getAngle=d.getDistance=void 0;const b=P,F=Math.PI;function z(e,i,t,l){if(e instanceof b.PrimitivePos&&i instanceof b.PrimitivePos)return Math.hypot(e.x-i.x,e.y-i.y);if(typeof e=="number"&&typeof i=="number"&&t!=null&&l!=null)return Math.hypot(e-t,i-l);throw new Error(`Invalid arguments! ${e} ${i} ${t} ${l}`)}d.getDistance=z;function I(e,i,t,l){if(e instanceof b.PrimitivePos&&i instanceof b.PrimitivePos)return Math.atan2(i.y-e.y,i.x-e.x);if(typeof e=="number"&&typeof i=="number"&&t!=null&&l!=null)return Math.atan2(l-i,t-e);throw new Error(`Invalid arguments! ${e} ${i} ${t} ${l}`)}d.getAngle=I;function ee(e,i,t){return e.add(Math.cos(i)*t,Math.sin(i)*t)}d.calcVec=ee;function ie(e){return F*e/180}d.toRad=ie;function te(e){return e*(180/F)}d.toDeg=te;function K(e,i,t){return e+(i-e)*t}d.lerp=K;function re(e,i,t){return new b.Pos(K(e.x,i.x,t),K(e.y,i.y,t))}d.lerpPos=re;function ne(e,i){return(360+i+((e-i+180+360)%360-180)/2)%360}d.averageAngle=ne;function H(e,i){return Math.random()*(i-e)+e}d.randFloat=H;function se(e,i){return Math.round(H(e,i))}d.randInt=se,Object.defineProperty(P,"__esModule",{value:!0});var v=P.Pos=P.PrimitivePos=void 0;const k=d;class C{constructor(i=0,t=0){this.x=i,this.y=t}normalize(){return new G(this.x,this.y)}}P.PrimitivePos=C;class G extends C{constructor(i=0,t=0){super(i,t),this.x=i,this.y=t}clone(){return new G(this.x,this.y)}addX(i){const t=this.clone();return t.x+=i,t}addY(i){const t=this.clone();return t.y+=i,t}add(i,t){return i instanceof G?this.addX(i.x).addY(i.y):this.addX(i).addY(t||0)}toString(){return`X: ${this.x} Y: ${this.y}`}asPrimitive(){return new C(this.x,this.y)}set(i){return this.x=i.x,this.y=i.y,this}dist(i){return(0,k.getDistance)(this,i)}dirTo(i){return(0,k.getAngle)(this,i)}}v=P.Pos=G;class w{constructor(i){this.eventName=i}}class V extends w{constructor(i){super("packet"),this.packet=i,this.payload=i[1]}}class ce extends V{constructor(i){super(i),this.type=i[0]}}class Y extends V{constructor(i){super(i),this.isCanceled=!1,this.type=i[0]}}class X extends w{constructor(i){super("player"),this.player=i}}class le extends w{constructor(i,t){super("health"),this.sid=i,this.health=t}}class J extends w{constructor(i){super("build"),this.building=i}}class oe extends J{constructor(i){super(i)}}class $ extends J{constructor(i,t){super(i),this.reason=t}getAsPos(){return new v(this.building.x,this.building.y)}}class ae extends w{constructor(i,t){super("chat"),this.sid=i,this.message=t}}class fe extends w{constructor(i){super("server_tick"),this.playerData=i}}class Ee extends w{constructor(i){super("projectile_add"),this.projectile=i}}class he extends w{constructor(i){super("projectile_remove"),this.projectile=i}}class q{constructor(i,t,l=!1){this.name=i,this.cb=t,this.once=l}}class ue{constructor(){this.events=[]}on(i,t){this.events.push(new q(i,t))}once(i,t){this.events.push(new q(i,t,!0))}emit(i,t){this.events.filter(l=>l.name!=i?!0:(l.cb(t),!l.once))}removeEvent(i){this.events.forEach(t=>{t.name==i&&(t.once=!0)})}}var O=(e=>(e.SPAWN="sp",e.CHAT="ch",e.ATTACK="c",e.PING="pp",e.SET_ANGLE="2",e.SELECT_ITEM="5",e.UPGRADE="6",e.SET_ATTACK_STATE="7",e.CREATE_TRIBE="8",e.LEAVE_TRIBE="9",e.REQUEST_JOIN_TRIBE="10",e.ACCEPT_TRIBE_REQUEST="11",e.KICK_FROM_TRIBE="12",e.BUY_AND_EQUIP="13c",e.PING_MAP="14",e.MOVE="33",e))(O||{}),p=(e=>(e.ANNOUNCE="ann",e.INIT="io-init",e.INIT_TRIBES="id",e.SET_SID="1",e.KICK="d",e.ADD_PLAYER="2",e.UPDAE_PLAYERS="33",e.REMOVE_PLAYER="4",e.UPDATE_LEADER_BOARD="5",e.ADD_OBJECT="6",e.UPDATE_AIS="a",e.PLAYER_SWING="7",e.MOOSTAFA_SWING="aa",e.WIGGLE="8",e.SHOOT_TURRET="sp",e.UPDATE_MATS="9",e.HEALTH="h",e.DEATH="11",e.REMOVE_OBJECT="12",e.REMOVE_ALL_OBJECTS="13",e.SET_ITEM_COUNT="14",e.SET_AGE="15",e.LIST_UPGRADES="16",e.SET_ITEMS_BAR="17",e.ADD_PROJECTILE="18",e.REMOVE_PROJECTILE="19",e.SERVER_RESTART="20",e.ADD_TRIBE="ac",e.DELETE_TRIBE="ad",e.REQUEST_JOIN_TRIBE="an",e.SET_TRIBE="st",e.SET_TRIBE_MEMBERS="sa",e.MINIMAP_LOCATIONS="mm",e.CHAT="ch",e.UPDATE_SHOP="us",e.PING="pp",e.DAMAGE_TEST="t",e.PING_MAP="p",e))(p||{}),_=(e=>(e[e.APPLE=0]="APPLE",e[e.COOKIE=1]="COOKIE",e[e.CHEESE=2]="CHEESE",e[e.WOOD_WALL=3]="WOOD_WALL",e[e.STONE_WALL=4]="STONE_WALL",e[e.CASTLE_WALL=5]="CASTLE_WALL",e[e.SPIKE=6]="SPIKE",e[e.GREATER_SPIKE=7]="GREATER_SPIKE",e[e.POISON_SPIKE=8]="POISON_SPIKE",e[e.SPINNING_SPIKE=9]="SPINNING_SPIKE",e[e.WINDMILL=10]="WINDMILL",e[e.FASTER_WINDMILL=11]="FASTER_WINDMILL",e[e.POWER_MILL=12]="POWER_MILL",e[e.MINE=13]="MINE",e[e.SAPPLING=14]="SAPPLING",e[e.PIT_TRAP=15]="PIT_TRAP",e[e.BOOST_PAD=16]="BOOST_PAD",e[e.TURRET=17]="TURRET",e[e.PLATFORM=18]="PLATFORM",e[e.HEALING_PAD=19]="HEALING_PAD",e[e.SPAWN_PAD=20]="SPAWN_PAD",e[e.BLOCKER=21]="BLOCKER",e[e.TELEPORTER=22]="TELEPORTER",e))(_||{}),y=(e=>(e[e.TOOL_HAMMER=0]="TOOL_HAMMER",e[e.HAND_AXE=1]="HAND_AXE",e[e.GREAT_AXE=2]="GREAT_AXE",e[e.SHORT_SWORD=3]="SHORT_SWORD",e[e.KATANA=4]="KATANA",e[e.POLE_ARM=5]="POLE_ARM",e[e.BAT=6]="BAT",e[e.DAGGERS=7]="DAGGERS",e[e.STICK=8]="STICK",e[e.HUNTING_BOW=9]="HUNTING_BOW",e[e.GREAT_HAMMER=10]="GREAT_HAMMER",e[e.WOODEN_SHIELD=11]="WOODEN_SHIELD",e[e.CROSSBOW=12]="CROSSBOW",e[e.REPEATER_CROSSBOW=13]="REPEATER_CROSSBOW",e[e.MC_GRABBY=14]="MC_GRABBY",e[e.MUSKET=15]="MUSKET",e))(y||{});class W extends v{constructor(){super(...arguments),this.x=-2,this.y=-2,this.sid=-2,this.id="NULL",this.dir=0,this.currentObject=-2,this.wep=-2,this.variant=-2,this.tribe="NULL",this.isLeader=!1,this.hat=-2,this.acc=-2,this.isSkull=!1,this.zIndex=-1,this.health=100,this.name="NULL",this.chatMessage=null,this.messageTimeout=-1}assign(i){this.x=i.x,this.y=i.y,this.sid=i.sid,this.dir=i.dir,this.currentObject=i.currentObject,this.wep=i.wep,this.variant=i.variant,this.tribe=i.tribe,this.isLeader=i.isLeader,this.hat=i.hat,this.acc=i.acc,this.isSkull=i.isSkull,this.zIndex=i.zIndex}getAsPos(){return this}}class Ae extends W{constructor(){super(...arguments),this.weapons=[y.TOOL_HAMMER,void 0],this.items=[_.APPLE,_.WOOD_WALL,_.SPIKE,_.WINDMILL,void 0,void 0,void 0,void 0]}getFoodType(){return this.items[0]}getWallType(){return this.items[1]}getSpikeType(){return this.items[2]}getMillType(){return this.items[3]}searchForId(i){for(let t of this.items)if(t==i)return t;return null}getSapplingType(){return this.searchForId(_.SAPPLING)}getMineType(){return this.searchForId(_.MINE)}getSpecialType(){return this.searchForId(_.TURRET)||this.searchForId(_.BLOCKER)||this.searchForId(_.HEALING_PAD)||this.searchForId(_.PLATFORM)||this.searchForId(_.TELEPORTER)}getPadType(){return this.items[4]||null}getPrimaryType(){return this.weapons[0]}getSecondaryType(){return this.weapons[1]}}function de(e){let t,l,s=new Uint8Array(128),a=0;return h(e),s.subarray(0,a);function h(n){switch(typeof n){case"undefined":u();break;case"boolean":T(n);break;case"number":N(n);break;case"string":M(n);break;case"object":n===null?u():n instanceof Date?r(n):Array.isArray(n)?m(n):n instanceof Uint8Array||n instanceof Uint8ClampedArray?R(n):n instanceof Int8Array||n instanceof Int16Array||n instanceof Uint16Array||n instanceof Int32Array||n instanceof Uint32Array||n instanceof Float32Array||n instanceof Float64Array?m(n):B(n);break}}function u(n){E(192)}function T(n){E(n?195:194)}function N(n){if(isFinite(n)&&Math.floor(n)===n)if(n>=0&&n<=127)E(n);else if(n<0&&n>=-32)E(n);else if(n>0&&n<=255)f([204,n]);else if(n>=-128&&n<=127)f([208,n]);else if(n>0&&n<=65535)f([205,n>>>8,n]);else if(n>=-32768&&n<=32767)f([209,n>>>8,n]);else if(n>0&&n<=4294967295)f([206,n>>>24,n>>>16,n>>>8,n]);else if(n>=-2147483648&&n<=2147483647)f([210,n>>>24,n>>>16,n>>>8,n]);else if(n>0&&n<=18446744073709552e3){let c=n/4294967296,o=n%4294967296;f([211,c>>>24,c>>>16,c>>>8,c,o>>>24,o>>>16,o>>>8,o])}else n>=-9223372036854776e3&&n<=9223372036854776e3?(E(211),x(n)):n<0?f([211,128,0,0,0,0,0,0,0]):f([207,255,255,255,255,255,255,255,255]);else l||(t=new ArrayBuffer(8),l=new DataView(t)),l.setFloat64(0,n),E(203),f(new Uint8Array(t))}function M(n){let c=_e(n),o=c.length;o<=31?E(160+o):o<=255?f([217,o]):o<=65535?f([218,o>>>8,o]):f([219,o>>>24,o>>>16,o>>>8,o]),f(c)}function m(n){let c=n.length;c<=15?E(144+c):c<=65535?f([220,c>>>8,c]):f([221,c>>>24,c>>>16,c>>>8,c]);for(let o=0;o<c;o++)h(n[o])}function R(n){let c=n.length;c<=15?f([196,c]):c<=65535?f([197,c>>>8,c]):f([198,c>>>24,c>>>16,c>>>8,c]),f(n)}function B(n){let c=0;for(let o in n)c++;c<=15?E(128+c):c<=65535?f([222,c>>>8,c]):f([223,c>>>24,c>>>16,c>>>8,c]);for(let o in n)h(o),h(n[o])}function r(n){let c=n.getTime()/1e3;if(n.getMilliseconds()===0&&c>=0&&c<4294967296)f([214,255,c>>>24,c>>>16,c>>>8,c]);else if(c>=0&&c<17179869184){let o=n.getMilliseconds()*1e6;f([215,255,o>>>22,o>>>14,o>>>6,o<<2>>>0|c/4294967296,c>>>24,c>>>16,c>>>8,c])}else{let o=n.getMilliseconds()*1e6;f([199,12,255,o>>>24,o>>>16,o>>>8,o]),x(c)}}function E(n){if(s.length<a+1){let c=s.length*2;for(;c<a+1;)c*=2;let o=new Uint8Array(c);o.set(s),s=o}s[a]=n,a++}function f(n){if(s.length<a+n.length){let c=s.length*2;for(;c<a+n.length;)c*=2;let o=new Uint8Array(c);o.set(s),s=o}s.set(n,a),a+=n.length}function x(n){let c,o;n>=0?(c=n/4294967296,o=n%4294967296):(n++,c=Math.abs(n)/4294967296,o=Math.abs(n)%4294967296,c=~c,o=~o),f([c>>>24,c>>>16,c>>>8,c,o>>>24,o>>>16,o>>>8,o])}}function pe(e){let t=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),typeof e!="object"||typeof e.length=="undefined")throw new Error("Invalid argument type: Expected a byte array (Array or Uint8Array) to deserialize.");if(!e.length)throw new Error("Invalid argument: The byte array to deserialize is empty.");e instanceof Uint8Array||(e=new Uint8Array(e));let l=s();return t<e.length,l;function s(){const r=e[t++];if(r>=0&&r<=127)return r;if(r>=128&&r<=143)return N(r-128);if(r>=144&&r<=159)return M(r-144);if(r>=160&&r<=191)return m(r-160);if(r===192)return null;if(r===193)throw new Error("Invalid byte code 0xc1 found.");if(r===194)return!1;if(r===195)return!0;if(r===196)return T(-1,1);if(r===197)return T(-1,2);if(r===198)return T(-1,4);if(r===199)return R(-1,1);if(r===200)return R(-1,2);if(r===201)return R(-1,4);if(r===202)return u(4);if(r===203)return u(8);if(r===204)return h(1);if(r===205)return h(2);if(r===206)return h(4);if(r===207)return h(8);if(r===208)return a(1);if(r===209)return a(2);if(r===210)return a(4);if(r===211)return a(8);if(r===212)return R(1);if(r===213)return R(2);if(r===214)return R(4);if(r===215)return R(8);if(r===216)return R(16);if(r===217)return m(-1,1);if(r===218)return m(-1,2);if(r===219)return m(-1,4);if(r===220)return M(-1,2);if(r===221)return M(-1,4);if(r===222)return N(-1,2);if(r===223)return N(-1,4);if(r>=224&&r<=255)return r-256;throw console.debug("msgpack array:",e),new Error("Invalid byte value '"+r+"' at index "+(t-1)+" in the MessagePack binary data (length "+e.length+"): Expecting a range of 0 to 255. This is not a byte array.")}function a(r){let E=0,f=!0;for(;r-- >0;)if(f){let x=e[t++];E+=x&127,x&128&&(E-=128),f=!1}else E*=256,E+=e[t++];return E}function h(r){let E=0;for(;r-- >0;)E*=256,E+=e[t++];return E}function u(r){let E=new DataView(e.buffer,t,r);if(t+=r,r===4)return E.getFloat32(0,!1);if(r===8)return E.getFloat64(0,!1)}function T(r,E){r<0&&(r=h(E));let f=e.subarray(t,t+r);return t+=r,f}function N(r,E){r<0&&(r=h(E));let f={};for(;r-- >0;){let x=s();f[x]=s()}return f}function M(r,E){r<0&&(r=h(E));let f=[];for(;r-- >0;)f.push(s());return f}function m(r,E){r<0&&(r=h(E));let f=t;return t+=r,Re(e,f,r)}function R(r,E){r<0&&(r=h(E));let f=h(1),x=T(r);switch(f){case 255:return B(x)}return{type:f,data:x}}function B(r){if(r.length===4){let E=(r[0]<<24>>>0)+(r[1]<<16>>>0)+(r[2]<<8>>>0)+r[3];return new Date(E*1e3)}if(r.length===8){let E=(r[0]<<22>>>0)+(r[1]<<14>>>0)+(r[2]<<6>>>0)+(r[3]>>>2),f=(r[3]&3)*4294967296+(r[4]<<24>>>0)+(r[5]<<16>>>0)+(r[6]<<8>>>0)+r[7];return new Date(f*1e3+E/1e6)}if(r.length===12){let E=(r[0]<<24>>>0)+(r[1]<<16>>>0)+(r[2]<<8>>>0)+r[3];t-=8;let f=a(8);return new Date(f*1e3+E/1e6)}throw new Error("Invalid data length for a date value.")}}function _e(e){let i=!0,t=e.length;for(let a=0;a<t;a++)if(e.charCodeAt(a)>127){i=!1;break}let l=0,s=new Uint8Array(e.length*(i?1:4));for(let a=0;a!==t;a++){let h=e.charCodeAt(a);if(h<128){s[l++]=h;continue}if(h<2048)s[l++]=h>>6|192;else{if(h>55295&&h<56320){if(++a>=t)throw new Error("UTF-8 encode: incomplete surrogate pair");let u=e.charCodeAt(a);if(u<56320||u>57343)throw new Error("UTF-8 encode: second surrogate character 0x"+u.toString(16)+" at index "+a+" out of range");h=65536+((h&1023)<<10)+(u&1023),s[l++]=h>>18|240,s[l++]=h>>12&63|128}else s[l++]=h>>12|224;s[l++]=h>>6&63|128}s[l++]=h&63|128}return i?s:s.subarray(0,l)}function Re(e,i,t){let l=i,s="";for(t+=i;l<t;){let a=e[l++];if(a>127)if(a>191&&a<224){if(l>=t)throw new Error("UTF-8 decode: incomplete 2-byte sequence");a=(a&31)<<6|e[l++]&63}else if(a>223&&a<240){if(l+1>=t)throw new Error("UTF-8 decode: incomplete 3-byte sequence");a=(a&15)<<12|(e[l++]&63)<<6|e[l++]&63}else if(a>239&&a<248){if(l+2>=t)throw new Error("UTF-8 decode: incomplete 4-byte sequence");a=(a&7)<<18|(e[l++]&63)<<12|(e[l++]&63)<<6|e[l++]&63}else throw new Error("UTF-8 decode: unknown multibyte start 0x"+a.toString(16)+" at index "+(l-1));if(a<=65535)s+=String.fromCharCode(a);else if(a<=1114111)a-=65536,s+=String.fromCharCode(a>>10|55296),s+=String.fromCharCode(a&1023|56320);else throw new Error("UTF-8 decode: code point 0x"+a.toString(16)+" exceeds UTF-16 reach")}return s}var Te=Object.freeze(Object.defineProperty({__proto__:null,msgpack:{encode:de,decode:pe}},Symbol.toStringTag,{value:"Module"})),j=(e=>(e[e.BROWN=0]="BROWN",e[e.BEIGE=1]="BEIGE",e[e.DARKBROWN=2]="DARKBROWN",e[e.PEACH=3]="PEACH",e[e.WHITE=4]="WHITE",e[e.RED=5]="RED",e[e.BLACK=6]="BLACK",e[e.PINK=7]="PINK",e[e.BLUE=8]="BLUE",e[e.GREEN=9]="GREEN",e.SECRETLIGHTBLUE="length",e))(j||{});class me{constructor(i,t,l){this.cb=i,this.msInterval=t,this.keyCode=l,this.intervalId=null}start(i){this.keyCode!=i||this.intervalId!=null||(this.intervalId=setInterval(this.cb,this.msInterval))}stop(i){this.keyCode!=i||this.intervalId==null||(clearInterval(this.intervalId),this.intervalId=null)}}class Oe extends v{constructor(i,t,l,s,a,h,u,T){super(t,l),this.id=i,this.dir=s,this.scale=a,this.type=h,this.buildType=u,this.ownerSid=T}getAsPos(){return this}}var U=(e=>(e[e.PLAYERLEAVE=0]="PLAYERLEAVE",e[e.BUILDINGBREAK=1]="BUILDINGBREAK",e))(U||{}),Q=(e=>(e[e.SHAME=45]="SHAME",e[e.MOO_CAP=51]="MOO_CAP",e[e.APPLE_CAP=50]="APPLE_CAP",e[e.MOO_HEAD=28]="MOO_HEAD",e[e.PIG_HEAD=29]="PIG_HEAD",e[e.FLUFF_HEAD=30]="FLUFF_HEAD",e[e.PANDOU_HEAD=36]="PANDOU_HEAD",e[e.BEAR_HEAD=37]="BEAR_HEAD",e[e.MONKEY_HEAD=38]="MONKEY_HEAD",e[e.POLAR_HEAD=44]="POLAR_HEAD",e[e.FEZ_HAT=35]="FEZ_HAT",e[e.ENIGMA_HAT=42]="ENIGMA_HAT",e[e.BLITZ_HAT=43]="BLITZ_HAT",e[e.BOB_XIII_HAT=49]="BOB_XIII_HAT",e[e.PUMPKIN=57]="PUMPKIN",e[e.BUMMLE_HAT=8]="BUMMLE_HAT",e[e.STRAW_HAT=2]="STRAW_HAT",e[e.WINTER_CAP=15]="WINTER_CAP",e[e.COWBOY_HAT=5]="COWBOY_HAT",e[e.RANGER_HAT=4]="RANGER_HAT",e[e.EXPLORER_HAT=18]="EXPLORER_HAT",e[e.FLIPPER_HAT=31]="FLIPPER_HAT",e[e.MARKSMAN_CAP=1]="MARKSMAN_CAP",e[e.BUSH_GEAR=10]="BUSH_GEAR",e[e.HALO=48]="HALO",e[e.SOLDIER_HELMET=6]="SOLDIER_HELMET",e[e.ANTI_VENOM_GEAR=23]="ANTI_VENOM_GEAR",e[e.MEDIC_GEAR=13]="MEDIC_GEAR",e[e.MINERS_HELMET=9]="MINERS_HELMET",e[e.MUSKETEER_HAT=32]="MUSKETEER_HAT",e[e.BULL_HELMET=7]="BULL_HELMET",e[e.EMP_HELMET=22]="EMP_HELMET",e[e.BOOSTER_HAT=12]="BOOSTER_HAT",e[e.BARBARIAN_ARMOR=26]="BARBARIAN_ARMOR",e[e.PLAGUE_MASK=21]="PLAGUE_MASK",e[e.BULL_MASK=46]="BULL_MASK",e[e.WINDMILL_HAT=14]="WINDMILL_HAT",e[e.SPIKE_GEAR=11]="SPIKE_GEAR",e[e.TURRET_GEAR=53]="TURRET_GEAR",e[e.SAMURAI_ARMOR=20]="SAMURAI_ARMOR",e[e.DARK_KNIGHT=58]="DARK_KNIGHT",e[e.SCAVENGER_GEAR=27]="SCAVENGER_GEAR",e[e.TANK_GEAR=40]="TANK_GEAR",e[e.THIEF_GEAR=40]="THIEF_GEAR",e[e.BLOODTHIRSTER=55]="BLOODTHIRSTER",e[e.Assassin_GEAR=56]="Assassin_GEAR",e))(Q||{});const ge=[{id:45,name:"Shame!",dontSell:!0,price:0,scale:120,desc:"hacks are for losers"},{id:51,name:"Moo Cap",price:0,scale:120,desc:"coolest mooer around"},{id:50,name:"Apple Cap",price:0,scale:120,desc:"apple farms remembers"},{id:28,name:"Moo Head",price:0,scale:120,desc:"no effect"},{id:29,name:"Pig Head",price:0,scale:120,desc:"no effect"},{id:30,name:"Fluff Head",price:0,scale:120,desc:"no effect"},{id:36,name:"Pandou Head",price:0,scale:120,desc:"no effect"},{id:37,name:"Bear Head",price:0,scale:120,desc:"no effect"},{id:38,name:"Monkey Head",price:0,scale:120,desc:"no effect"},{id:44,name:"Polar Head",price:0,scale:120,desc:"no effect"},{id:35,name:"Fez Hat",price:0,scale:120,desc:"no effect"},{id:42,name:"Enigma Hat",price:0,scale:120,desc:"join the enigma army"},{id:43,name:"Blitz Hat",price:0,scale:120,desc:"hey everybody i'm blitz"},{id:49,name:"Bob XIII Hat",price:0,scale:120,desc:"like and subscribe"},{id:57,name:"Pumpkin",price:50,scale:120,desc:"Spooooky"},{id:8,name:"Bummle Hat",price:100,scale:120,desc:"no effect"},{id:2,name:"Straw Hat",price:500,scale:120,desc:"no effect"},{id:15,name:"Winter Cap",price:600,scale:120,desc:"allows you to move at normal speed in snow",coldM:1},{id:5,name:"Cowboy Hat",price:1e3,scale:120,desc:"no effect"},{id:4,name:"Ranger Hat",price:2e3,scale:120,desc:"no effect"},{id:18,name:"Explorer Hat",price:2e3,scale:120,desc:"no effect"},{id:31,name:"Flipper Hat",price:2500,scale:120,desc:"have more control while in water",watrImm:!0},{id:1,name:"Marksman Cap",price:3e3,scale:120,desc:"increases arrow speed and range",aMlt:1.3},{id:10,name:"Bush Gear",price:3e3,scale:160,desc:"allows you to disguise yourself as a bush"},{id:48,name:"Halo",price:3e3,scale:120,desc:"no effect"},{id:6,name:"Soldier Helmet",price:4e3,scale:120,desc:"reduces damage taken but slows movement",spdMult:.94,dmgMult:.75},{id:23,name:"Anti Venom Gear",price:4e3,scale:120,desc:"makes you immune to poison",poisonRes:1},{id:13,name:"Medic Gear",price:5e3,scale:110,desc:"slowly regenerates health over time",healthRegen:3},{id:9,name:"Miners Helmet",price:5e3,scale:120,desc:"earn 1 extra gold per resource",extraGold:1},{id:32,name:"Musketeer Hat",price:5e3,scale:120,desc:"reduces cost of projectiles",projCost:.5},{id:7,name:"Bull Helmet",price:6e3,scale:120,desc:"increases damage done but drains health",healthRegen:-5,dmgMultO:1.5,spdMult:.96},{id:22,name:"Emp Helmet",price:6e3,scale:120,desc:"turrets won't attack but you move slower",antiTurret:1,spdMult:.7},{id:12,name:"Booster Hat",price:6e3,scale:120,desc:"increases your movement speed",spdMult:1.16},{id:26,name:"Barbarian Armor",price:8e3,scale:120,desc:"knocks back enemies that attack you",dmgK:.6},{id:21,name:"Plague Mask",price:1e4,scale:120,desc:"melee attacks deal poison damage",poisonDmg:5,poisonTime:6},{id:46,name:"Bull Mask",price:1e4,scale:120,desc:"bulls won't target you unless you attack them",bullRepel:1},{id:14,name:"Windmill Hat",topSprite:!0,price:1e4,scale:120,desc:"generates points while worn",pps:1.5},{id:11,name:"Spike Gear",topSprite:!0,price:1e4,scale:120,desc:"deal damage to players that damage you",dmg:.45},{id:53,name:"Turret Gear",topSprite:!0,price:1e4,scale:120,desc:"you become a walking turret",turret:{proj:1,range:700,rate:2500},spdMult:.7},{id:20,name:"Samurai Armor",price:12e3,scale:120,desc:"increased attack speed and fire rate",atkSpd:.78},{id:58,name:"Dark Knight",price:12e3,scale:120,desc:"restores health when you deal damage",healD:.4},{id:27,name:"Scavenger Gear",price:15e3,scale:120,desc:"earn double points for each kill",kScrM:2},{id:40,name:"Tank Gear",price:15e3,scale:120,desc:"increased damage to buildings but slower movement",spdMult:.3,bDmg:3.3},{id:52,name:"Thief Gear",price:15e3,scale:120,desc:"steal half of a players gold when you kill them",goldSteal:.5},{id:55,name:"Bloodthirster",price:2e4,scale:120,desc:"Restore Health when dealing damage. And increased damage",healD:.25,dmgMultO:1.2},{id:56,name:"Assassin Gear",price:2e4,scale:120,desc:"Go invisible when not moving. Can't eat. Increased speed",noEat:!0,spdMult:1.1,invisTimer:1e3}];var Z=(e=>(e[e.SNOWBALL=12]="SNOWBALL",e[e.TREE_CAPE=9]="TREE_CAPE",e[e.STONE_CAPE=10]="STONE_CAPE",e[e.COOKIE_CAPE=3]="COOKIE_CAPE",e[e.COW_CAPE=8]="COW_CAPE",e[e.MONKEY_TAIL=11]="MONKEY_TAIL",e[e.APPLE_BASKET=17]="APPLE_BASKET",e[e.WINTER_CAPE=6]="WINTER_CAPE",e[e.SKULL_CAPE=4]="SKULL_CAPE",e[e.DASH_CAPE=5]="DASH_CAPE",e[e.DRAGON_CAPE=2]="DRAGON_CAPE",e[e.SUPER_CAPE=1]="SUPER_CAPE",e[e.TROLL_CAPE=7]="TROLL_CAPE",e[e.THORNS=14]="THORNS",e[e.BLOCKADES=15]="BLOCKADES",e[e.DEVILS_TAIL=20]="DEVILS_TAIL",e[e.SAWBLADE=16]="SAWBLADE",e[e.ANGEL_WINGS=13]="ANGEL_WINGS",e[e.SHADOW_WINGS=19]="SHADOW_WINGS",e[e.BLOOD_WINGS=18]="BLOOD_WINGS",e[e.CORRUPT_X_WINGS=21]="CORRUPT_X_WINGS",e))(Z||{});const xe=[{id:12,name:"Snowball",price:1e3,scale:105,xOff:18,desc:"no effect"},{id:9,name:"Tree Cape",price:1e3,scale:90,desc:"no effect"},{id:10,name:"Stone Cape",price:1e3,scale:90,desc:"no effect"},{id:3,name:"Cookie Cape",price:1500,scale:90,desc:"no effect"},{id:8,name:"Cow Cape",price:2e3,scale:90,desc:"no effect"},{id:11,name:"Monkey Tail",price:2e3,scale:97,xOff:25,desc:"Super speed but reduced damage",spdMult:1.35,dmgMultO:.2},{id:17,name:"Apple Basket",price:3e3,scale:80,xOff:12,desc:"slowly regenerates health over time",healthRegen:1},{id:6,name:"Winter Cape",price:3e3,scale:90,desc:"no effect"},{id:4,name:"Skull Cape",price:4e3,scale:90,desc:"no effect"},{id:5,name:"Dash Cape",price:5e3,scale:90,desc:"no effect"},{id:2,name:"Dragon Cape",price:6e3,scale:90,desc:"no effect"},{id:1,name:"Super Cape",price:8e3,scale:90,desc:"no effect"},{id:7,name:"Troll Cape",price:8e3,scale:90,desc:"no effect"},{id:14,name:"Thorns",price:1e4,scale:115,xOff:20,desc:"no effect"},{id:15,name:"Blockades",price:1e4,scale:95,xOff:15,desc:"no effect"},{id:20,name:"Devils Tail",price:1e4,scale:95,xOff:20,desc:"no effect"},{id:16,name:"Sawblade",price:12e3,scale:90,spin:!0,xOff:0,desc:"deal damage to players that damage you",dmg:.15},{id:13,name:"Angel Wings",price:15e3,scale:138,xOff:22,desc:"slowly regenerates health over time",healthRegen:3},{id:19,name:"Shadow Wings",price:15e3,scale:138,xOff:22,desc:"increased movement speed",spdMult:1.1},{id:18,name:"Blood Wings",price:2e4,scale:178,xOff:26,desc:"restores health when you deal damage",healD:.2},{id:21,name:"Corrupt X Wings",price:2e4,scale:178,xOff:26,desc:"deal damage to players that damage you",dmg:.25}];class Le{constructor(i,t,l,s,a,h,u,T){this.x=i,this.y=t,this.dir=l,this.range=s,this.speed=a,this.projectileType=h,this.layer=u,this.sid=T}getAsPos(){return new v(this.x,this.y)}}var Pe=Te;const D=Pe.msgpack;var Me=Date.now();class g extends ue{constructor(i=!1){super(),this.socket=null,this.player=new Ae,this.players=[],this.gameObjects=[],this.alive=!1,this.hatsOwned={},this.accessoriesOwned={},this.projectiles=[],this.isAutoAtk=!1;const t=this;if(i)Object.defineProperty(WebSocket.prototype,"hiddenSend",{value:WebSocket.prototype.send}),Object.defineProperty(WebSocket.prototype,"send",{value:function(l){t.socket==null&&(t.socket=this);const s=new Y(D.decode(new Uint8Array(l)));if(t.emit("packetSend",s),s.isCanceled)return;s.type==O.SPAWN&&(t.alive=!0),this.hiddenSend(l)}});else{class l extends WebSocket{hiddenSend(a){super.send(a)}constructor(a){super(a),this.send=h=>{const u=new Y(D.decode(new Uint8Array(h)));t.emit("packetSend",u),!u.isCanceled&&(u.type==O.SPAWN?t.alive=!0:u.type==O.SET_ATTACK_STATE&&u.payload[0]&&(t.isAutoAtk=!t.isAutoAtk),this.hiddenSend(h))},t.socket=this,t.initSocket()}}Object.defineProperty(window,"WebSocket",{value:l})}ge.forEach(l=>{l.price<=0&&!l.dontSell&&(this.hatsOwned[l.id]=!0)}),xe.forEach(l=>{l.price<=0&&(this.accessoriesOwned[l.id]=!0)})}initSocket(){var i;(i=this.socket)==null||i.addEventListener("message",t=>{const l=new ce(D.decode(new Uint8Array(t.data)));this.emit("packetReceive",l);const s=l.payload;switch(l.type){case p.HEALTH:const T=s[0];this.emit("health",new le(T,s[1])),this.players[T].health=s[1];break;case p.INIT:this.player.id=s[0];break;case p.SET_SID:this.players[s[0]]=this.player,this.player.sid=s[0];break;case p.UPDAE_PLAYERS:var h=[];const N=Date.now();for(const o of this.projectiles)o.range-=(N-Me)*o.speed,o.range<=0&&this.removeProjectile(o.sid);for(let o=0;o<s[0].length;o+=13){const A=s[0].slice(o,o+13),L={sid:A[0],x:A[1],y:A[2],dir:A[3],currentObject:A[4],wep:A[5],variant:A[6],tribe:A[7],isLeader:A[8],hat:A[9],acc:A[10],isSkull:A[11],zIndex:A[12]};this.players[L.sid]||(console.warn("Ran into unpredicted circumstance current player cannot be found, IPlayerDat, this.players, IPlayerDat.sid",L,this.players,L.sid),this.players[L.sid]=new W),this.emit("updatePlayer",L),this.players[L.sid].assign(L),h.push(L)}this.emit("serverTick",new fe(h));break;case p.REMOVE_PLAYER:const M=this.getPlayerById(s[0]);M&&(this.emit("playerLeave",new X(M)),delete this.players[M.sid]);break;case p.ADD_PLAYER:const m=s[0],R=m[1];var u=this.player;R!=this.player.sid&&(u=new W),u.sid=R,u.id=m[0],u.name=m[2],u.x=m[3],u.y=m[4],this.players[R]=u,this.emit("addPlayer",new X(u));break;case p.ADD_OBJECT:for(let o=0;o<s[0].length;o+=8){const A=s[0].slice(o,o+8),L=new Oe(A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7]);this.gameObjects[L.id]=L,this.emit("addObject",new oe(L))}break;case p.REMOVE_OBJECT:this.emit("removeObject",new $(this.gameObjects[s[0]],U.BUILDINGBREAK)),delete this.gameObjects[s[0]];break;case p.REMOVE_ALL_OBJECTS:for(let o=0;o<this.gameObjects.length;o++){const A=this.gameObjects[o];!A||A.ownerSid==s[0]&&(this.emit("removeObject",new $(this.gameObjects[o],U.PLAYERLEAVE)),this.gameObjects.slice(o,1))}break;case p.SET_ITEMS_BAR:s[0]&&(s[1]?this.player.weapons=s[0]:this.player.items=s[0]);break;case p.DEATH:this.isAutoAtk=!1,this.player.weapons=[y.TOOL_HAMMER,void 0],this.player.items=[_.APPLE,_.WOOD_WALL,_.SPIKE,_.WINDMILL,void 0,void 0,void 0,void 0];break;case p.CHAT:const B=s[0],r=this.getPlayerBySid(B);if(r==null)return;const E=s[1];clearTimeout(r.messageTimeout),r.chatMessage=E,r.messageTimeout=setTimeout(()=>{r.chatMessage=null},3e3),this.emit("chat",new ae(B,E));break;case p.UPDATE_SHOP:if(s[0])break;const x=s[2],n=s[1];x?this.accessoriesOwned[n]=!0:this.hatsOwned[n]=!0;break;case p.ADD_PROJECTILE:const c=new Le(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]);this.emit("addProjectile",new Ee(c)),this.projectiles.push(c);break;case p.REMOVE_PROJECTILE:this.removeProjectile(s[0]);break}})}getPlayerById(i){for(let t of this.players)if((t==null?void 0:t.id)==i)return t;return null}getPlayerBySid(i){for(let t of this.players)if((t==null?void 0:t.sid)==i)return t;return null}sendRaw(i){var t;(t=this.socket)==null||t.send(D.encode(i))}sendBasic(i,...t){this.sendRaw([i,t])}sendHidden(i,...t){var l=this.socket;l==null||l.hiddenSend(D.encode([i,t]))}spawn(i="moomooapi",t=j.RED,l=!0){this.sendBasic(O.SPAWN,{name:i,skin:t,moofoll:l})}setHand(i,t){this.sendBasic(O.SELECT_ITEM,i,t)}setItem(i){this.setHand(i,!1)}setWeapon(i){this.setHand(i,!0)}attack(i,t=null){this.sendBasic(O.ATTACK,i,t)}singleSwing(i=null){this.attack(!0,i),this.attack(!1)}placeItem(i,t=null){this.setItem(i),this.singleSwing(t),this.setWeapon(this.player.wep)}toggleAutoAttack(){this.sendBasic(O.SET_ATTACK_STATE,1)}setGear(i,t,l){this.sendBasic(O.BUY_AND_EQUIP,i,t,l)}buyGear(i,t){this.setGear(!0,i,t)}buyHat(i){this.buyGear(i,!1)}equipGear(i,t){this.setGear(!1,i,t)}equipHat(i){this.equipGear(i,!1)}buyAccessory(i){this.buyGear(i,!0)}equipAccessory(i){this.equipGear(i,!0)}chat(i){this.sendBasic(O.CHAT,i)}removeProjectile(i){for(let t=0;t<this.projectiles.length;t++)this.projectiles[t].sid==i&&(this.emit("removeProjectile",new he(this.projectiles[t])),this.projectiles.splice(t,1))}setDirection(i){this.sendBasic(O.SET_ANGLE,i)}lookAt(i){this.setDirection(this.player.getAsPos().dirTo(i))}}g.SkinColours=j,g.C2SPacketType=O,g.S2CPacketType=p,g.ObjectRemoveReason=U,g.ItemIds=_,g.WeaponIds=y,g.Repeater=me,g.msgpack=D,g.HatIds=Q,g.AccessoryIds=Z,Object.defineProperty(window,"MooMooAPI",{value:g}),S.MooMooAPI=g,S.msgpack2=D,Object.defineProperties(S,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
